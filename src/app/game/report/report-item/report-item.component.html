<div class="row">
  <div class="col-12 d-flex">
    <div>
      {{report | json}}
      <span class="badge" [ngClass]="{'badge-danger': report.result === 'lose', 'badge-success': report.result === 'win'}">{{report.result}}</span>
      <span>{{report.originTown.name}} ({{report.originTown.location}}) attacks {{ report.targetTown.name}} ({{report.targetTown.location}})</span>
      <span class="text-muted">{{report.createdAt | date:'yy-MM-dd HH:mm:ss' }}</span>
    </div>
    <fa-icon class="ml-auto" [icon]="['fas', 'chevron-down']" (click)="isCollapsed = !isCollapsed" [attr.aria-expanded]="!isCollapsed" [attr.aria-controls]="'collapse-' + report.id"></fa-icon>
  </div>
  <div [id]="'collapse-' + report.id" class="col-12 py-2 px-1" [ngbCollapse]="!isCollapsed">
    <section>
      <header class="font-weight-bold">Defender - {{report.targetTown.name}} ({{report.targetTown.location}})</header>
      <div class="row">
        <div class="col">
          <div>Units</div>
          <div>Amount</div>
          <div>Losses</div>
        </div>
        <div class="col d-flex flex-column align-items-center" *ngFor="let unit of unitList">
          <div class="unit-icon" [attr.data-unit]="unit.name"></div>
          <div>{{ report.target.units[unit.name] || 0 }}</div>
          <div class="text-danger">{{ report.target.losses[unit.name] || 0 }}</div>
        </div>
      </div>
    </section>
    <section>
      <header class="font-weight-bold">Attacker - {{report.originTown.name}} ({{report.originTown.location}})</header>
      <div class="row">
        <div class="col">
          <div>Units</div>
          <div>Amount</div>
          <div>Losses</div>
        </div>
        <div class="col d-flex flex-column align-items-center" *ngFor="let unit of unitList">
          <div class="unit-icon" [attr.data-unit]="unit.name"></div>
          <div>{{ report.origin.units[unit.name] || 0 }}</div>
          <div class="text-danger">{{ report.origin.losses[unit.name] || 0 }}</div>
        </div>
      </div>
    </section>
    <section class="d-flex justify-content-end" *ngIf="report.outcome === attackType">
      <div *ngIf="report.loyaltyChange[0] !== report.loyaltyChange[1]" class="mr-3">
        Loyalty decreased by <strong>{{ (report.loyaltyChange[1] - report.loyaltyChange[0]) * -1 }}</strong> from <strong>{{ report.loyaltyChange[0] }}</strong> to <strong>{{ report.loyaltyChange[1] }}</strong>
      </div>
      <div>Haul:</div>
      <div class="d-flex">
        <div class="resource">
          <div class="resource-icon wood"></div>
          {{report.haul.haul.wood | number:'1.0-0'}}
        </div>
        <div class="resource">
          <div class="resource-icon clay"></div>
          {{report.haul.haul.clay | number:'1.0-0'}}
        </div>
        <div class="resource">
          <div class="resource-icon iron"></div>
          {{report.haul.haul.iron | number:'1.0-0'}}
        </div>
      </div>
      <div>/{{report.haul.maxHaul}}</div>
    </section>
  </div>
</div>
